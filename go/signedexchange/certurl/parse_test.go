package certurl_test

import (
	"testing"

	"github.com/kylelemons/godebug/pretty"

	. "github.com/nyaxt/webpackage/go/signedexchange/certurl"
)

func TestParsePEM(t *testing.T) {
	in := []byte(`-----BEGIN CERTIFICATE-----
MIIF8jCCBNqgAwIBAgIQDmTF+8I2reFLFyrrQceMsDANBgkqhkiG9w0BAQsFADBw
MQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3
d3cuZGlnaWNlcnQuY29tMS8wLQYDVQQDEyZEaWdpQ2VydCBTSEEyIEhpZ2ggQXNz
dXJhbmNlIFNlcnZlciBDQTAeFw0xNTExMDMwMDAwMDBaFw0xODExMjgxMjAwMDBa
MIGlMQswCQYDVQQGEwJVUzETMBEGA1UECBMKQ2FsaWZvcm5pYTEUMBIGA1UEBxML
TG9zIEFuZ2VsZXMxPDA6BgNVBAoTM0ludGVybmV0IENvcnBvcmF0aW9uIGZvciBB
c3NpZ25lZCBOYW1lcyBhbmQgTnVtYmVyczETMBEGA1UECxMKVGVjaG5vbG9neTEY
MBYGA1UEAxMPd3d3LmV4YW1wbGUub3JnMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8A
MIIBCgKCAQEAs0CWL2FjPiXBl61lRfvvE0KzLJmG9LWAC3bcBjgsH6NiVVo2dt6u
Xfzi5bTm7F3K7srfUBYkLO78mraM9qizrHoIeyofrV/n+pZZJauQsPjCPxMEJnRo
D8Z4KpWKX0LyDu1SputoI4nlQ/htEhtiQnuoBfNZxF7WxcxGwEsZuS1KcXIkHl5V
RJOreKFHTaXcB1qcZ/QRaBIv0yhxvK1yBTwWddT4cli6GfHcCe3xGMaSL328Fgs3
jYrvG29PueB6VJi/tbbPu6qTfwp/H1brqdjh29U52Bhb0fJkM9DWxCP/Cattcc7a
z8EXnCO+LK8vkhw/kAiJWPKx4RBvgy73nwIDAQABo4ICUDCCAkwwHwYDVR0jBBgw
FoAUUWj/kK8CB3U8zNllZGKiErhZcjswHQYDVR0OBBYEFKZPYB4fLdHn8SOgKpUW
5Oia6m5IMIGBBgNVHREEejB4gg93d3cuZXhhbXBsZS5vcmeCC2V4YW1wbGUuY29t
ggtleGFtcGxlLmVkdYILZXhhbXBsZS5uZXSCC2V4YW1wbGUub3Jngg93d3cuZXhh
bXBsZS5jb22CD3d3dy5leGFtcGxlLmVkdYIPd3d3LmV4YW1wbGUubmV0MA4GA1Ud
DwEB/wQEAwIFoDAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwdQYDVR0f
BG4wbDA0oDKgMIYuaHR0cDovL2NybDMuZGlnaWNlcnQuY29tL3NoYTItaGEtc2Vy
dmVyLWc0LmNybDA0oDKgMIYuaHR0cDovL2NybDQuZGlnaWNlcnQuY29tL3NoYTIt
aGEtc2VydmVyLWc0LmNybDBMBgNVHSAERTBDMDcGCWCGSAGG/WwBATAqMCgGCCsG
AQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2VydC5jb20vQ1BTMAgGBmeBDAECAjCB
gwYIKwYBBQUHAQEEdzB1MCQGCCsGAQUFBzABhhhodHRwOi8vb2NzcC5kaWdpY2Vy
dC5jb20wTQYIKwYBBQUHMAKGQWh0dHA6Ly9jYWNlcnRzLmRpZ2ljZXJ0LmNvbS9E
aWdpQ2VydFNIQTJIaWdoQXNzdXJhbmNlU2VydmVyQ0EuY3J0MAwGA1UdEwEB/wQC
MAAwDQYJKoZIhvcNAQELBQADggEBAISomhGn2L0LJn5SJHuyVZ3qMIlRCIdvqe0Q
6ls+C8ctRwRO3UU3x8q8OH+2ahxlQmpzdC5al4XQzJLiLjiJ2Q1p+hub8MFiMmVP
PZjb2tZm2ipWVuMRM+zgpRVM6nVJ9F3vFfUSHOb4/JsEIUvPY+d8/Krc+kPQwLvy
ieqRbcuFjmqfyPmUv1U9QoI4TQikpw7TZU0zYZANP4C/gj4Ry48/znmUaRvy2kvI
l7gRQ21qJTK5suoiYoYNo3J9T+pXPGU7Lydz/HwW+w0DpArtAaukI8aNX4ohFUKS
wDSiIIWIWJiJGbEeIO0TIFwEVWTOnbNl/faPXpk5IRXicapqiII=
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIEsTCCA5mgAwIBAgIQBOHnpNxc8vNtwCtCuF0VnzANBgkqhkiG9w0BAQsFADBs
MQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3
d3cuZGlnaWNlcnQuY29tMSswKQYDVQQDEyJEaWdpQ2VydCBIaWdoIEFzc3VyYW5j
ZSBFViBSb290IENBMB4XDTEzMTAyMjEyMDAwMFoXDTI4MTAyMjEyMDAwMFowcDEL
MAkGA1UEBhMCVVMxFTATBgNVBAoTDERpZ2lDZXJ0IEluYzEZMBcGA1UECxMQd3d3
LmRpZ2ljZXJ0LmNvbTEvMC0GA1UEAxMmRGlnaUNlcnQgU0hBMiBIaWdoIEFzc3Vy
YW5jZSBTZXJ2ZXIgQ0EwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC2
4C/CJAbIbQRf1+8KZAayfSImZRauQkCbztyfn3YHPsMwVYcZuU+UDlqUH1VWtMIC
Kq/QmO4LQNfE0DtyyBSe75CxEamu0si4QzrZCwvV1ZX1QK/IHe1NnF9Xt4ZQaJn1
itrSxwUfqJfJ3KSxgoQtxq2lnMcZgqaFD15EWCo3j/018QsIJzJa9buLnqS9UdAn
4t07QjOjBSjEuyjMmqwrIw14xnvmXnG3Sj4I+4G3FhahnSMSTeXXkgisdaScus0X
sh5ENWV/UyU50RwKmmMbGZJ0aAo3wsJSSMs5WqK24V3B3aAguCGikyZvFEohQcft
bZvySC/zA/WiaJJTL17jAgMBAAGjggFJMIIBRTASBgNVHRMBAf8ECDAGAQH/AgEA
MA4GA1UdDwEB/wQEAwIBhjAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIw
NAYIKwYBBQUHAQEEKDAmMCQGCCsGAQUFBzABhhhodHRwOi8vb2NzcC5kaWdpY2Vy
dC5jb20wSwYDVR0fBEQwQjBAoD6gPIY6aHR0cDovL2NybDQuZGlnaWNlcnQuY29t
L0RpZ2lDZXJ0SGlnaEFzc3VyYW5jZUVWUm9vdENBLmNybDA9BgNVHSAENjA0MDIG
BFUdIAAwKjAoBggrBgEFBQcCARYcaHR0cHM6Ly93d3cuZGlnaWNlcnQuY29tL0NQ
UzAdBgNVHQ4EFgQUUWj/kK8CB3U8zNllZGKiErhZcjswHwYDVR0jBBgwFoAUsT7D
aQP4v0cB1JgmGggC72NkK8MwDQYJKoZIhvcNAQELBQADggEBABiKlYkD5m3fXPwd
aOpKj4PWUS+Na0QWnqxj9dJubISZi6qBcYRb7TROsLd5kinMLYBq8I4g4Xmk/gNH
E+r1hspZcX30BJZr01lYPf7TMSVcGDiEo+afgv2MW5gxTs14nhr9hctJqvIni5ly
/D6q1UEL2tU2ob8cbkdJf17ZSHwD2f2LSaCYJkJA69aSEaRkCldUxPUd1gJea6zu
xICaEnL6VpPX/78whQYwvwt/Tv9XBZ0k7YXDK/umdaisLRbvfXknsuvCnQsH6qqF
0wGjIChBWUMo0oHjqvbsezt3tkBigAVBRQHvFwY+3sAzm2fTYS5yh+Rp/BIAV0Ae
cPUeybQ=
-----END CERTIFICATE-----
`)

	want := []byte{0, 0, 10, 181, 0, 5, 246, 48, 130, 5, 242, 48, 130, 4, 218, 160,
		3, 2, 1, 2, 2, 16, 14, 100, 197, 251, 194, 54, 173, 225, 75, 23,
		42, 235, 65, 199, 140, 176, 48, 13, 6, 9, 42, 134, 72, 134, 247, 13,
		1, 1, 11, 5, 0, 48, 112, 49, 11, 48, 9, 6, 3, 85, 4, 6,
		19, 2, 85, 83, 49, 21, 48, 19, 6, 3, 85, 4, 10, 19, 12, 68,
		105, 103, 105, 67, 101, 114, 116, 32, 73, 110, 99, 49, 25, 48, 23, 6,
		3, 85, 4, 11, 19, 16, 119, 119, 119, 46, 100, 105, 103, 105, 99, 101,
		114, 116, 46, 99, 111, 109, 49, 47, 48, 45, 6, 3, 85, 4, 3, 19,
		38, 68, 105, 103, 105, 67, 101, 114, 116, 32, 83, 72, 65, 50, 32, 72,
		105, 103, 104, 32, 65, 115, 115, 117, 114, 97, 110, 99, 101, 32, 83, 101,
		114, 118, 101, 114, 32, 67, 65, 48, 30, 23, 13, 49, 53, 49, 49, 48,
		51, 48, 48, 48, 48, 48, 48, 90, 23, 13, 49, 56, 49, 49, 50, 56,
		49, 50, 48, 48, 48, 48, 90, 48, 129, 165, 49, 11, 48, 9, 6, 3,
		85, 4, 6, 19, 2, 85, 83, 49, 19, 48, 17, 6, 3, 85, 4, 8,
		19, 10, 67, 97, 108, 105, 102, 111, 114, 110, 105, 97, 49, 20, 48, 18,
		6, 3, 85, 4, 7, 19, 11, 76, 111, 115, 32, 65, 110, 103, 101, 108,
		101, 115, 49, 60, 48, 58, 6, 3, 85, 4, 10, 19, 51, 73, 110, 116,
		101, 114, 110, 101, 116, 32, 67, 111, 114, 112, 111, 114, 97, 116, 105, 111,
		110, 32, 102, 111, 114, 32, 65, 115, 115, 105, 103, 110, 101, 100, 32, 78,
		97, 109, 101, 115, 32, 97, 110, 100, 32, 78, 117, 109, 98, 101, 114, 115,
		49, 19, 48, 17, 6, 3, 85, 4, 11, 19, 10, 84, 101, 99, 104, 110,
		111, 108, 111, 103, 121, 49, 24, 48, 22, 6, 3, 85, 4, 3, 19, 15,
		119, 119, 119, 46, 101, 120, 97, 109, 112, 108, 101, 46, 111, 114, 103, 48,
		130, 1, 34, 48, 13, 6, 9, 42, 134, 72, 134, 247, 13, 1, 1, 1,
		5, 0, 3, 130, 1, 15, 0, 48, 130, 1, 10, 2, 130, 1, 1, 0,
		179, 64, 150, 47, 97, 99, 62, 37, 193, 151, 173, 101, 69, 251, 239, 19,
		66, 179, 44, 153, 134, 244, 181, 128, 11, 118, 220, 6, 56, 44, 31, 163,
		98, 85, 90, 54, 118, 222, 174, 93, 252, 226, 229, 180, 230, 236, 93, 202,
		238, 202, 223, 80, 22, 36, 44, 238, 252, 154, 182, 140, 246, 168, 179, 172,
		122, 8, 123, 42, 31, 173, 95, 231, 250, 150, 89, 37, 171, 144, 176, 248,
		194, 63, 19, 4, 38, 116, 104, 15, 198, 120, 42, 149, 138, 95, 66, 242,
		14, 237, 82, 166, 235, 104, 35, 137, 229, 67, 248, 109, 18, 27, 98, 66,
		123, 168, 5, 243, 89, 196, 94, 214, 197, 204, 70, 192, 75, 25, 185, 45,
		74, 113, 114, 36, 30, 94, 85, 68, 147, 171, 120, 161, 71, 77, 165, 220,
		7, 90, 156, 103, 244, 17, 104, 18, 47, 211, 40, 113, 188, 173, 114, 5,
		60, 22, 117, 212, 248, 114, 88, 186, 25, 241, 220, 9, 237, 241, 24, 198,
		146, 47, 125, 188, 22, 11, 55, 141, 138, 239, 27, 111, 79, 185, 224, 122,
		84, 152, 191, 181, 182, 207, 187, 170, 147, 127, 10, 127, 31, 86, 235, 169,
		216, 225, 219, 213, 57, 216, 24, 91, 209, 242, 100, 51, 208, 214, 196, 35,
		255, 9, 171, 109, 113, 206, 218, 207, 193, 23, 156, 35, 190, 44, 175, 47,
		146, 28, 63, 144, 8, 137, 88, 242, 177, 225, 16, 111, 131, 46, 247, 159,
		2, 3, 1, 0, 1, 163, 130, 2, 80, 48, 130, 2, 76, 48, 31, 6,
		3, 85, 29, 35, 4, 24, 48, 22, 128, 20, 81, 104, 255, 144, 175, 2,
		7, 117, 60, 204, 217, 101, 100, 98, 162, 18, 184, 89, 114, 59, 48, 29,
		6, 3, 85, 29, 14, 4, 22, 4, 20, 166, 79, 96, 30, 31, 45, 209,
		231, 241, 35, 160, 42, 149, 22, 228, 232, 154, 234, 110, 72, 48, 129, 129,
		6, 3, 85, 29, 17, 4, 122, 48, 120, 130, 15, 119, 119, 119, 46, 101,
		120, 97, 109, 112, 108, 101, 46, 111, 114, 103, 130, 11, 101, 120, 97, 109,
		112, 108, 101, 46, 99, 111, 109, 130, 11, 101, 120, 97, 109, 112, 108, 101,
		46, 101, 100, 117, 130, 11, 101, 120, 97, 109, 112, 108, 101, 46, 110, 101,
		116, 130, 11, 101, 120, 97, 109, 112, 108, 101, 46, 111, 114, 103, 130, 15,
		119, 119, 119, 46, 101, 120, 97, 109, 112, 108, 101, 46, 99, 111, 109, 130,
		15, 119, 119, 119, 46, 101, 120, 97, 109, 112, 108, 101, 46, 101, 100, 117,
		130, 15, 119, 119, 119, 46, 101, 120, 97, 109, 112, 108, 101, 46, 110, 101,
		116, 48, 14, 6, 3, 85, 29, 15, 1, 1, 255, 4, 4, 3, 2, 5,
		160, 48, 29, 6, 3, 85, 29, 37, 4, 22, 48, 20, 6, 8, 43, 6,
		1, 5, 5, 7, 3, 1, 6, 8, 43, 6, 1, 5, 5, 7, 3, 2,
		48, 117, 6, 3, 85, 29, 31, 4, 110, 48, 108, 48, 52, 160, 50, 160,
		48, 134, 46, 104, 116, 116, 112, 58, 47, 47, 99, 114, 108, 51, 46, 100,
		105, 103, 105, 99, 101, 114, 116, 46, 99, 111, 109, 47, 115, 104, 97, 50,
		45, 104, 97, 45, 115, 101, 114, 118, 101, 114, 45, 103, 52, 46, 99, 114,
		108, 48, 52, 160, 50, 160, 48, 134, 46, 104, 116, 116, 112, 58, 47, 47,
		99, 114, 108, 52, 46, 100, 105, 103, 105, 99, 101, 114, 116, 46, 99, 111,
		109, 47, 115, 104, 97, 50, 45, 104, 97, 45, 115, 101, 114, 118, 101, 114,
		45, 103, 52, 46, 99, 114, 108, 48, 76, 6, 3, 85, 29, 32, 4, 69,
		48, 67, 48, 55, 6, 9, 96, 134, 72, 1, 134, 253, 108, 1, 1, 48,
		42, 48, 40, 6, 8, 43, 6, 1, 5, 5, 7, 2, 1, 22, 28, 104,
		116, 116, 112, 115, 58, 47, 47, 119, 119, 119, 46, 100, 105, 103, 105, 99,
		101, 114, 116, 46, 99, 111, 109, 47, 67, 80, 83, 48, 8, 6, 6, 103,
		129, 12, 1, 2, 2, 48, 129, 131, 6, 8, 43, 6, 1, 5, 5, 7,
		1, 1, 4, 119, 48, 117, 48, 36, 6, 8, 43, 6, 1, 5, 5, 7,
		48, 1, 134, 24, 104, 116, 116, 112, 58, 47, 47, 111, 99, 115, 112, 46,
		100, 105, 103, 105, 99, 101, 114, 116, 46, 99, 111, 109, 48, 77, 6, 8,
		43, 6, 1, 5, 5, 7, 48, 2, 134, 65, 104, 116, 116, 112, 58, 47,
		47, 99, 97, 99, 101, 114, 116, 115, 46, 100, 105, 103, 105, 99, 101, 114,
		116, 46, 99, 111, 109, 47, 68, 105, 103, 105, 67, 101, 114, 116, 83, 72,
		65, 50, 72, 105, 103, 104, 65, 115, 115, 117, 114, 97, 110, 99, 101, 83,
		101, 114, 118, 101, 114, 67, 65, 46, 99, 114, 116, 48, 12, 6, 3, 85,
		29, 19, 1, 1, 255, 4, 2, 48, 0, 48, 13, 6, 9, 42, 134, 72,
		134, 247, 13, 1, 1, 11, 5, 0, 3, 130, 1, 1, 0, 132, 168, 154,
		17, 167, 216, 189, 11, 38, 126, 82, 36, 123, 178, 85, 157, 234, 48, 137,
		81, 8, 135, 111, 169, 237, 16, 234, 91, 62, 11, 199, 45, 71, 4, 78,
		221, 69, 55, 199, 202, 188, 56, 127, 182, 106, 28, 101, 66, 106, 115, 116,
		46, 90, 151, 133, 208, 204, 146, 226, 46, 56, 137, 217, 13, 105, 250, 27,
		155, 240, 193, 98, 50, 101, 79, 61, 152, 219, 218, 214, 102, 218, 42, 86,
		86, 227, 17, 51, 236, 224, 165, 21, 76, 234, 117, 73, 244, 93, 239, 21,
		245, 18, 28, 230, 248, 252, 155, 4, 33, 75, 207, 99, 231, 124, 252, 170,
		220, 250, 67, 208, 192, 187, 242, 137, 234, 145, 109, 203, 133, 142, 106, 159,
		200, 249, 148, 191, 85, 61, 66, 130, 56, 77, 8, 164, 167, 14, 211, 101,
		77, 51, 97, 144, 13, 63, 128, 191, 130, 62, 17, 203, 143, 63, 206, 121,
		148, 105, 27, 242, 218, 75, 200, 151, 184, 17, 67, 109, 106, 37, 50, 185,
		178, 234, 34, 98, 134, 13, 163, 114, 125, 79, 234, 87, 60, 101, 59, 47,
		39, 115, 252, 124, 22, 251, 13, 3, 164, 10, 237, 1, 171, 164, 35, 198,
		141, 95, 138, 33, 21, 66, 146, 192, 52, 162, 32, 133, 136, 88, 152, 137,
		25, 177, 30, 32, 237, 19, 32, 92, 4, 85, 100, 206, 157, 179, 101, 253,
		246, 143, 94, 153, 57, 33, 21, 226, 113, 170, 106, 136, 130, 0, 0, 0,
		4, 181, 48, 130, 4, 177, 48, 130, 3, 153, 160, 3, 2, 1, 2, 2,
		16, 4, 225, 231, 164, 220, 92, 242, 243, 109, 192, 43, 66, 184, 93, 21,
		159, 48, 13, 6, 9, 42, 134, 72, 134, 247, 13, 1, 1, 11, 5, 0,
		48, 108, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49,
		21, 48, 19, 6, 3, 85, 4, 10, 19, 12, 68, 105, 103, 105, 67, 101,
		114, 116, 32, 73, 110, 99, 49, 25, 48, 23, 6, 3, 85, 4, 11, 19,
		16, 119, 119, 119, 46, 100, 105, 103, 105, 99, 101, 114, 116, 46, 99, 111,
		109, 49, 43, 48, 41, 6, 3, 85, 4, 3, 19, 34, 68, 105, 103, 105,
		67, 101, 114, 116, 32, 72, 105, 103, 104, 32, 65, 115, 115, 117, 114, 97,
		110, 99, 101, 32, 69, 86, 32, 82, 111, 111, 116, 32, 67, 65, 48, 30,
		23, 13, 49, 51, 49, 48, 50, 50, 49, 50, 48, 48, 48, 48, 90, 23,
		13, 50, 56, 49, 48, 50, 50, 49, 50, 48, 48, 48, 48, 90, 48, 112,
		49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49, 21, 48,
		19, 6, 3, 85, 4, 10, 19, 12, 68, 105, 103, 105, 67, 101, 114, 116,
		32, 73, 110, 99, 49, 25, 48, 23, 6, 3, 85, 4, 11, 19, 16, 119,
		119, 119, 46, 100, 105, 103, 105, 99, 101, 114, 116, 46, 99, 111, 109, 49,
		47, 48, 45, 6, 3, 85, 4, 3, 19, 38, 68, 105, 103, 105, 67, 101,
		114, 116, 32, 83, 72, 65, 50, 32, 72, 105, 103, 104, 32, 65, 115, 115,
		117, 114, 97, 110, 99, 101, 32, 83, 101, 114, 118, 101, 114, 32, 67, 65,
		48, 130, 1, 34, 48, 13, 6, 9, 42, 134, 72, 134, 247, 13, 1, 1,
		1, 5, 0, 3, 130, 1, 15, 0, 48, 130, 1, 10, 2, 130, 1, 1,
		0, 182, 224, 47, 194, 36, 6, 200, 109, 4, 95, 215, 239, 10, 100, 6,
		178, 125, 34, 38, 101, 22, 174, 66, 64, 155, 206, 220, 159, 159, 118, 7,
		62, 195, 48, 85, 135, 25, 185, 79, 148, 14, 90, 148, 31, 85, 86, 180,
		194, 2, 42, 175, 208, 152, 238, 11, 64, 215, 196, 208, 59, 114, 200, 20,
		158, 239, 144, 177, 17, 169, 174, 210, 200, 184, 67, 58, 217, 11, 11, 213,
		213, 149, 245, 64, 175, 200, 29, 237, 77, 156, 95, 87, 183, 134, 80, 104,
		153, 245, 138, 218, 210, 199, 5, 31, 168, 151, 201, 220, 164, 177, 130, 132,
		45, 198, 173, 165, 156, 199, 25, 130, 166, 133, 15, 94, 68, 88, 42, 55,
		143, 253, 53, 241, 11, 8, 39, 50, 90, 245, 187, 139, 158, 164, 189, 81,
		208, 39, 226, 221, 59, 66, 51, 163, 5, 40, 196, 187, 40, 204, 154, 172,
		43, 35, 13, 120, 198, 123, 230, 94, 113, 183, 74, 62, 8, 251, 129, 183,
		22, 22, 161, 157, 35, 18, 77, 229, 215, 146, 8, 172, 117, 164, 156, 186,
		205, 23, 178, 30, 68, 53, 101, 127, 83, 37, 57, 209, 28, 10, 154, 99,
		27, 25, 146, 116, 104, 10, 55, 194, 194, 82, 72, 203, 57, 90, 162, 182,
		225, 93, 193, 221, 160, 32, 184, 33, 162, 147, 38, 111, 20, 74, 33, 65,
		199, 237, 109, 155, 242, 72, 47, 243, 3, 245, 162, 104, 146, 83, 47, 94,
		227, 2, 3, 1, 0, 1, 163, 130, 1, 73, 48, 130, 1, 69, 48, 18,
		6, 3, 85, 29, 19, 1, 1, 255, 4, 8, 48, 6, 1, 1, 255, 2,
		1, 0, 48, 14, 6, 3, 85, 29, 15, 1, 1, 255, 4, 4, 3, 2,
		1, 134, 48, 29, 6, 3, 85, 29, 37, 4, 22, 48, 20, 6, 8, 43,
		6, 1, 5, 5, 7, 3, 1, 6, 8, 43, 6, 1, 5, 5, 7, 3,
		2, 48, 52, 6, 8, 43, 6, 1, 5, 5, 7, 1, 1, 4, 40, 48,
		38, 48, 36, 6, 8, 43, 6, 1, 5, 5, 7, 48, 1, 134, 24, 104,
		116, 116, 112, 58, 47, 47, 111, 99, 115, 112, 46, 100, 105, 103, 105, 99,
		101, 114, 116, 46, 99, 111, 109, 48, 75, 6, 3, 85, 29, 31, 4, 68,
		48, 66, 48, 64, 160, 62, 160, 60, 134, 58, 104, 116, 116, 112, 58, 47,
		47, 99, 114, 108, 52, 46, 100, 105, 103, 105, 99, 101, 114, 116, 46, 99,
		111, 109, 47, 68, 105, 103, 105, 67, 101, 114, 116, 72, 105, 103, 104, 65,
		115, 115, 117, 114, 97, 110, 99, 101, 69, 86, 82, 111, 111, 116, 67, 65,
		46, 99, 114, 108, 48, 61, 6, 3, 85, 29, 32, 4, 54, 48, 52, 48,
		50, 6, 4, 85, 29, 32, 0, 48, 42, 48, 40, 6, 8, 43, 6, 1,
		5, 5, 7, 2, 1, 22, 28, 104, 116, 116, 112, 115, 58, 47, 47, 119,
		119, 119, 46, 100, 105, 103, 105, 99, 101, 114, 116, 46, 99, 111, 109, 47,
		67, 80, 83, 48, 29, 6, 3, 85, 29, 14, 4, 22, 4, 20, 81, 104,
		255, 144, 175, 2, 7, 117, 60, 204, 217, 101, 100, 98, 162, 18, 184, 89,
		114, 59, 48, 31, 6, 3, 85, 29, 35, 4, 24, 48, 22, 128, 20, 177,
		62, 195, 105, 3, 248, 191, 71, 1, 212, 152, 38, 26, 8, 2, 239, 99,
		100, 43, 195, 48, 13, 6, 9, 42, 134, 72, 134, 247, 13, 1, 1, 11,
		5, 0, 3, 130, 1, 1, 0, 24, 138, 149, 137, 3, 230, 109, 223, 92,
		252, 29, 104, 234, 74, 143, 131, 214, 81, 47, 141, 107, 68, 22, 158, 172,
		99, 245, 210, 110, 108, 132, 153, 139, 170, 129, 113, 132, 91, 237, 52, 78,
		176, 183, 121, 146, 41, 204, 45, 128, 106, 240, 142, 32, 225, 121, 164, 254,
		3, 71, 19, 234, 245, 134, 202, 89, 113, 125, 244, 4, 150, 107, 211, 89,
		88, 61, 254, 211, 49, 37, 92, 24, 56, 132, 163, 230, 159, 130, 253, 140,
		91, 152, 49, 78, 205, 120, 158, 26, 253, 133, 203, 73, 170, 242, 39, 139,
		153, 114, 252, 62, 170, 213, 65, 11, 218, 213, 54, 161, 191, 28, 110, 71,
		73, 127, 94, 217, 72, 124, 3, 217, 253, 139, 73, 160, 152, 38, 66, 64,
		235, 214, 146, 17, 164, 100, 10, 87, 84, 196, 245, 29, 214, 2, 94, 107,
		172, 238, 196, 128, 154, 18, 114, 250, 86, 147, 215, 255, 191, 48, 133, 6,
		48, 191, 11, 127, 78, 255, 87, 5, 157, 36, 237, 133, 195, 43, 251, 166,
		117, 168, 172, 45, 22, 239, 125, 121, 39, 178, 235, 194, 157, 11, 7, 234,
		170, 133, 211, 1, 163, 32, 40, 65, 89, 67, 40, 210, 129, 227, 170, 246,
		236, 123, 59, 119, 182, 64, 98, 128, 5, 65, 69, 1, 239, 23, 6, 62,
		222, 192, 51, 155, 103, 211, 97, 46, 114, 135, 228, 105, 252, 18, 0, 87,
		64, 30, 112, 245, 30, 201, 180, 0, 0}

	got, err := CertificateMessageFromPEM(in)
	if err != nil {
		t.Errorf("failed to parse PEM: %v", err)
	}

	if diff := pretty.Compare(got, want); diff != "" {
		t.Errorf("ParsePEM: %v", diff)
	}
}
